angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout",function(e,t){var i={};return e&&angular.extend(i,e),{require:"ngModel",priority:1,compile:function(e,n){var l,a,r,s=e.is("select"),o=angular.isDefined(n.multiple);return e.is("select")&&(a=e.find("optgroup[ng-repeat], optgroup[data-ng-repeat], option[ng-repeat], option[data-ng-repeat]")).length&&(r=a.attr("ng-repeat")||a.attr("data-ng-repeat"),l=jQuery.trim(r.split("|")[0]).split(" ").pop()),function(e,a,r,u){var c=angular.extend({},i,e.$eval(r.uiSelect2)),g=function(e){var t;return c.simple_tags?(t=[],angular.forEach(e,(function(e,i){t.push(e.id)}))):t=e,t};if(s?(delete c.multiple,delete c.initSelection):o&&(c.multiple=!0),u&&(e.$watch(n.ngModel,(function(e,t){e&&e!==t&&u.$render()}),!0),u.$render=function(){if(s)a.select2("val",u.$viewValue);else if(c.multiple){u.$isEmpty=function(e){return!e||0===e.length};var e=u.$viewValue;angular.isString(e)&&(e=e.split(",")),a.select2("data",(i=[],(t=e)?(c.simple_tags?(i=[],angular.forEach(t,(function(e,t){i.push({id:e,text:e})}))):i=t,i):i)),c.sortable&&a.select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){a.select2("onSortStart")},update:function(){a.select2("onSortEnd"),a.trigger("change")}})}else angular.isObject(u.$viewValue)?a.select2("data",u.$viewValue):u.$viewValue?a.select2("val",u.$viewValue):a.select2("data",null);var t,i},l&&e.$watch(l,(function(e,i,n){angular.equals(e,i)||t((function(){a.select2("val",u.$viewValue),u.$render(),e&&!i&&u.$setPristine&&u.$setPristine(!0)}))})),u.$parsers.push((function(e){return a.prev().toggleClass("ng-invalid",!u.$valid).toggleClass("ng-valid",u.$valid).toggleClass("ng-invalid-required",!u.$valid).toggleClass("ng-valid-required",u.$valid).toggleClass("ng-dirty",u.$dirty).toggleClass("ng-pristine",u.$pristine),e})),!s&&(a.bind("change",(function(t){t.stopImmediatePropagation(),e.$$phase||e.$root.$$phase||e.$apply((function(){u.$setViewValue(g(a.select2("data")))}))})),c.initSelection))){var p=c.initSelection;c.initSelection=function(e,t){p(e,(function(e){var i=u.$pristine;u.$setViewValue(g(e)),t(e),i&&u.$setPristine(),a.prev().toggleClass("ng-pristine",u.$pristine)}))}}a.bind("$destroy",(function(){a.select2("destroy")})),r.$observe("disabled",(function(e){a.select2("enable",!e)})),r.$observe("readonly",(function(e){a.select2("readonly",!!e)})),r.ngMultiple&&e.$watch(r.ngMultiple,(function(e){r.$set("multiple",!!e),a.select2(c)})),t((function(){if(a.select2(c),a.select2("data",u.$modelValue),u.$render(),!c.initSelection&&!s){var e=u.$pristine;u.$pristine=!1,u.$setViewValue(g(a.select2("data"))),e&&u.$setPristine(),a.prev().toggleClass("ng-pristine",u.$pristine)}}))}}}}]);